<!DOCTYPE html>
<html
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://xmlns.jcp.org/jsf/html"
        xmlns:f="http://xmlns.jcp.org/jsf/core"
        xmlns:p="http://primefaces.org/ui">

<h:head>
  <title>Gestão de Produtos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
</h:head>

<h:body>
  <h:form id="formPrincipal">

    <p:messages id="messages" showDetail="true" closable="true"/>

    <div style="display:flex; justify-content:flex-end; margin-bottom:10px;">
      <p:link href="telainicial.xhtml" styleClass="p-button-text">
        <i class="pi pi-arrow-left" style="margin-right:5px;"></i>
        Voltar ao Menu Principal
      </p:link>
    </div>

    <p:panel header="Cadastro de Produtos" style="margin-bottom:15px">

      <div style="display:flex; gap:15px; flex-wrap:wrap; margin-bottom:10px;">
        <div style="display:flex; flex-direction:column;">
          <p:outputLabel value="Código:" for="codigo"/>
          <p:inputText id="codigo" value="#{produtoBean.produto.codigo}" required="true"
                       requiredMessage="Código é obrigatório"/>
        </div>

        <div style="display:flex; flex-direction:column;">
          <p:outputLabel value="Descrição:" for="descricao"/>
          <p:inputText id="descricao" value="#{produtoBean.produto.descricao}" required="true"
                       requiredMessage="Descrição é obrigatória"/>
        </div>

        <div style="display:flex; flex-direction:column;">
          <p:outputLabel value="Data Entrada:" for="dataEntrada"/>
          <p:calendar id="dataEntrada" value="#{produtoBean.produto.data_entrada}" pattern="dd/MM/yyyy"
                      required="true"/>
        </div>

        <div style="display:flex; flex-direction:column;">
          <p:outputLabel value="Data Validade:" for="dataValidade"/>
          <p:calendar id="dataValidade" value="#{produtoBean.produto.data_validade}" pattern="dd/MM/yyyy"
                      required="true"/>
        </div>

        <div style="display:flex; flex-direction:column;">
          <p:outputLabel value="Quantidade:" for="quantidade"/>
          <p:inputNumber id="quantidade" value="#{produtoBean.produto.quantidade}" decimalPlaces="0" minValue="0"
                         required="true"/>
        </div>
      </div>

      <div style="display:flex; gap:10px;">
        <p:commandButton value="Salvar" icon="pi pi-save" action="#{produtoBean.incluir}" update="formPrincipal"/>
        <p:commandButton value="Alterar" icon="pi pi-pencil" action="#{produtoBean.alterar}" update="formPrincipal"/>
        <p:commandButton value="Limpar" icon="pi pi-times" action="#{produtoBean.limpar}" update="formPrincipal" process="@this"/>
      </div>

    </p:panel>

    <p:panel header="Lista de Produtos">
      <p:dataTable id="tabela" value="#{produtoBean.produtos}" var="produto" paginator="true" rows="10"
                   emptyMessage="Nenhum produto encontrado" paginatorPosition="top">

        <p:column headerText="ID">
          <h:outputText value="#{produto.id}"/>
        </p:column>

        <p:column headerText="Código">
          <h:outputText value="#{produto.codigo}"/>
        </p:column>

        <p:column headerText="Descrição">
          <h:outputText value="#{produto.descricao}"/>
        </p:column>

        <p:column headerText="Data Entrada">
          <h:outputText value="#{produto.data_entrada}">
            <f:convertDateTime pattern="dd/MM/yyyy"/>
          </h:outputText>
        </p:column>

        <p:column headerText="Data Validade">
          <h:outputText value="#{produto.data_validade}">
            <f:convertDateTime pattern="dd/MM/yyyy"/>
          </h:outputText>
        </p:column>

        <p:column headerText="Quantidade">
          <h:outputText value="#{produto.quantidade}"/>
        </p:column>

        <p:column headerText="Status">
          <h:outputText value="ATIVO"/>
        </p:column>

        <p:column headerText="Ações" style="width:140px">
          <p:commandButton icon="pi pi-pencil" title="Editar"
                           action="#{produtoBean.editar(produto)}" process="@this"
                           update="formPrincipal" style="margin-right:5px"/>
          <p:commandButton icon="pi pi-trash" title="Excluir"
                           action="#{produtoBean.excluir(produto)}" process="@this"
                           update="formPrincipal">
            <p:confirm header="Confirmação" message="Deseja realmente excluir este produto?"
                       icon="pi pi-exclamation-triangle"/>
          </p:commandButton>
        </p:column>

      </p:dataTable>
    </p:panel>

    <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
      <p:commandButton value="Sim" type="button" styleClass="ui-confirmdialog-yes" icon="pi pi-check"/>
      <p:commandButton value="Não" type="button" styleClass="ui-confirmdialog-no"  icon="pi pi-times"/>
    </p:confirmDialog>

  </h:form>
</h:body>

</html>
